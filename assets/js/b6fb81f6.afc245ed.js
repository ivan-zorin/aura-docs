"use strict";(self.webpackChunk_localzet_aura_docs=self.webpackChunk_localzet_aura_docs||[]).push([[7026],{3869:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"install/reverse-proxies/nginx","title":"Nginx","description":"Popular reverse proxy with manual SSL certificates","source":"@site/docs/install/reverse-proxies/nginx.md","sourceDirName":"install/reverse-proxies","slug":"/install/reverse-proxies/nginx","permalink":"/docs/install/reverse-proxies/nginx","draft":false,"unlisted":false,"editUrl":"https://github.com/localzet/aura-docs/tree/main/docs/install/reverse-proxies/nginx.md","tags":[],"version":"current","lastUpdatedBy":"Ivan Zorin","lastUpdatedAt":1750179473000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Nginx","description":"Popular reverse proxy with manual SSL certificates"},"sidebar":"tutorialSidebar","previous":{"title":"Caddy","permalink":"/docs/install/reverse-proxies/caddy"},"next":{"title":"Traefik","permalink":"/docs/install/reverse-proxies/traefik"}}');var s=r(4848),o=r(8453),t=r(4499),a=r(4446);const l={sidebar_position:2,title:"Nginx",description:"Popular reverse proxy with manual SSL certificates"},c=void 0,d={},h=[{value:"Overview",id:"overview",level:2},...t.RM,{value:"Issue an SSL certificate",id:"issue-an-ssl-certificate",level:2},{value:"Install dependencies",id:"install-dependencies",level:3},{value:"Install acme.sh",id:"install-acmesh",level:3},{value:"Create a folder for the certificates",id:"create-a-folder-for-the-certificates",level:3},{value:"Issue a certificate",id:"issue-a-certificate",level:3},{value:"Nginx configuration",id:"nginx-configuration",level:2},{value:"Simple configuration",id:"simple-configuration",level:3},{value:"Create docker-compose.yml",id:"create-docker-composeyml",level:3},{value:"Start the container",id:"start-the-container",level:3},...a.RM];function p(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"In this guide we will be using Nginx as a reverse proxy to access the Aura panel.\r\nWe will point a domain name to our server, issue a SSL certificate and configure Nginx."}),"\n",(0,s.jsx)(t.Ay,{}),"\n",(0,s.jsx)(n.h2,{id:"issue-an-ssl-certificate",children:"Issue an SSL certificate"}),"\n",(0,s.jsxs)(n.p,{children:["Now, you need to issue an SSL certificate. The most easy way is to use ",(0,s.jsx)(n.a,{href:"https://acme.sh/",children:"acme.sh"}),"."]}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"This guide will cover only issuing SSL certificate for the domain of the panel."})}),"\n",(0,s.jsx)(n.h3,{id:"install-dependencies",children:"Install dependencies"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo apt-get install cron socat\n"})}),"\n",(0,s.jsx)(n.h3,{id:"install-acmesh",children:"Install acme.sh"}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"You can use any email address to issue the certificate, but it is recommended to use a valid one."})}),"\n",(0,s.jsxs)(n.p,{children:["Replace ",(0,s.jsx)(n.code,{children:"EMAIL"})," with your email address."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl https://get.acme.sh | sh -s email=EMAIL && source ~/.bashrc\n"})}),"\n",(0,s.jsx)(n.h3,{id:"create-a-folder-for-the-certificates",children:"Create a folder for the certificates"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mkdir -p /opt/aura/nginx && cd /opt/aura/nginx\n"})}),"\n",(0,s.jsx)(n.h3,{id:"issue-a-certificate",children:"Issue a certificate"}),"\n",(0,s.jsxs)(n.p,{children:["Replace ",(0,s.jsx)(n.code,{children:"DOMAIN"})," with the domain name you want to issue a certificate for."]}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"Do not use domain zones: .ru, .su, .\u0440\u0444. Currently ZeroSSL does not support these zones."})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"acme.sh --issue --standalone -d 'DOMAIN' --key-file /opt/aura/nginx/privkey.key --fullchain-file /opt/aura/nginx/fullchain.pem --alpn --tlsport 8443\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Make sure that port ",(0,s.jsx)(n.strong,{children:"8443"})," is open on your server. It is required for certificate issuance."]})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:r(5144).A+"",width:"1107",height:"533"})}),"\n",(0,s.jsxs)(n.p,{children:["This shows that the certificate is issued. ",(0,s.jsx)(n.code,{children:"Acme.sh"})," will take care of automatically renewing the certificate every 60 days, just make sure that you have a ",(0,s.jsx)(n.strong,{children:"8443"})," port open (and not busy) on your server."]}),"\n",(0,s.jsx)(n.h2,{id:"nginx-configuration",children:"Nginx configuration"}),"\n",(0,s.jsx)(n.h3,{id:"simple-configuration",children:"Simple configuration"}),"\n",(0,s.jsxs)(n.p,{children:["Create a file called ",(0,s.jsx)(n.code,{children:"nginx.conf"})," in the ",(0,s.jsx)(n.code,{children:"/opt/aura/nginx"})," directory."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd /opt/aura/nginx && nano nginx.conf\n"})}),"\n",(0,s.jsx)(n.p,{children:"Paste the following configuration."}),"\n",(0,s.jsxs)(n.admonition,{type:"warning",children:[(0,s.jsxs)(n.p,{children:["Please, replace ",(0,s.jsx)(n.code,{children:"REPLACE_WITH_YOUR_DOMAIN"})," with your domain name."]}),(0,s.jsx)(n.p,{children:"Review the configuration below, look for red highlighted lines."})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",metastring:'title="nginx.conf"',children:'upstream aura-backend {\r\n    server aura-backend:3000;\r\n}\r\n\r\n# Connection header for WebSocket reverse proxy\r\nmap $http_upgrade $connection_upgrade {\r\n    default upgrade;\r\n    "" close;\r\n}\r\n\r\nserver {\r\n    // highlight-next-line-red\r\n    server_name REPLACE_WITH_YOUR_DOMAIN;\r\n\r\n    listen 443 ssl reuseport;\r\n    listen [::]:443 ssl reuseport;\r\n    http2 on;\r\n\r\n    location / {\r\n        proxy_http_version 1.1;\r\n        proxy_pass http://remnawave;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header Upgrade $http_upgrade;\r\n        proxy_set_header Connection $connection_upgrade;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n        proxy_set_header X-Forwarded-Proto $scheme;\r\n    }\r\n\r\n    # SSL Configuration (Mozilla Intermediate Guidelines)\r\n    ssl_protocols          TLSv1.2 TLSv1.3;\r\n    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-CHACHA20-POLY1305;\r\n\r\n    ssl_session_timeout 1d;\r\n    ssl_session_cache shared:MozSSL:1m;\r\n    ssl_session_tickets    off;\r\n    ssl_certificate "/etc/nginx/ssl/fullchain.pem";\r\n    ssl_certificate_key "/etc/nginx/ssl/privkey.key";\r\n    ssl_trusted_certificate "/etc/nginx/ssl/fullchain.pem";\r\n\r\n    ssl_stapling           on;\r\n    ssl_stapling_verify    on;\r\n    resolver               1.1.1.1 1.0.0.1 8.8.8.8 8.8.4.4 208.67.222.222 208.67.220.220 valid=60s;\r\n    resolver_timeout       2s;\r\n\r\n    # Gzip Compression\r\n    gzip on;\r\n    gzip_vary on;\r\n    gzip_proxied any;\r\n    gzip_comp_level 6;\r\n    gzip_buffers 16 8k;\r\n    gzip_http_version 1.1;\r\n    gzip_min_length 256;\r\n    gzip_types\r\n    application/atom+xml\r\n    application/geo+json\r\n    application/javascript\r\n    application/x-javascript\r\n    application/json\r\n    application/ld+json\r\n    application/manifest+json\r\n    application/rdf+xml\r\n    application/rss+xml\r\n    application/xhtml+xml\r\n    application/xml\r\n    font/eot\r\n    font/otf\r\n    font/ttf\r\n    image/svg+xml\r\n    text/css\r\n    text/javascript\r\n    text/plain\r\n    text/xml;\r\n}\r\n\r\nserver {\r\n    listen 443 ssl default_server;\r\n    listen [::]:443 ssl default_server;\r\n    server_name _;\r\n\r\n    ssl_reject_handshake on;\r\n}\r\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"create-docker-composeyml",children:"Create docker-compose.yml"}),"\n",(0,s.jsxs)(n.p,{children:["Create a ",(0,s.jsx)(n.code,{children:"docker-compose.yml"})," file in the ",(0,s.jsx)(n.code,{children:"/opt/aura/nginx"})," directory."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd /opt/aura/nginx && nano docker-compose.yml\n"})}),"\n",(0,s.jsx)(n.p,{children:"Paste the following configuration."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="docker-compose.yml"',children:"services:\r\n    remnawave-nginx:\r\n        image: nginx:1.26\r\n        container_name: remnawave-nginx\r\n        hostname: remnawave-nginx\r\n        volumes:\r\n            - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro\r\n            - ./fullchain.pem:/etc/nginx/ssl/fullchain.pem:ro\r\n            - ./privkey.key:/etc/nginx/ssl/privkey.key:ro\r\n        restart: always\r\n        ports:\r\n            - '0.0.0.0:443:443'\r\n        networks:\r\n            - aura-network\r\n\r\nnetworks:\r\n    aura-network:\r\n        name: aura-network\r\n        driver: bridge\r\n        external: true\n"})}),"\n",(0,s.jsx)(n.h3,{id:"start-the-container",children:"Start the container"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker compose up -d && docker compose logs -f -t\n"})}),"\n",(0,s.jsx)(a.Ay,{})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},4446:(e,n,r)=>{r.d(n,{Ay:()=>a,RM:()=>o});var i=r(4848),s=r(8453);const o=[{value:"Open the panel in the browser",id:"open-the-panel-in-the-browser",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2}];function t(e){const n={h2:"h2",h3:"h3",img:"img",p:"p",...(0,s.R)(),...e.components},{Button:o}=n;return o||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Button",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h3,{id:"open-the-panel-in-the-browser",children:"Open the panel in the browser"}),"\n",(0,i.jsx)(n.p,{children:"Open the configured domain name in the browser and you will see the login page."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"login-page",src:r(3935).A+"",width:"960",height:"720"})}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(o,{label:"Ask community",link:"https://t.me/+YxzE4bOmEog2Zjhi",variant:"secondary",size:"md",outline:!0,style:{marginBottom:"1rem"}})]})}function a(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},4499:(e,n,r)=>{r.d(n,{Ay:()=>a,RM:()=>o});var i=r(4848),s=r(8453);const o=[{value:"Point domain to your server",id:"point-domain-to-your-server",level:2},{value:"DNS provider",id:"dns-provider",level:3}];function t(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"You need to have a registered domain name to continue."})}),"\n",(0,i.jsx)(n.h2,{id:"point-domain-to-your-server",children:"Point domain to your server"}),"\n",(0,i.jsx)(n.p,{children:"Check your server's IP address. It is better to use a static IPv4 address."}),"\n",(0,i.jsx)(n.p,{children:"Now, you need to point your domain name to this IP address."}),"\n",(0,i.jsxs)(n.p,{children:["For example, it will be ",(0,i.jsx)(n.code,{children:"my-super-panel.com"})," -> ",(0,i.jsx)(n.code,{children:"193.122.122.122"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"There are two ways to do this:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Use a DNS provider (e.g. Cloudflare, Google Cloud, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"Use a registrar (e.g. Namecheap, etc.)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"dns-provider",children:"DNS provider"}),"\n",(0,i.jsx)(n.p,{children:"If you are using Cloudflare, you need to add a A/AAAA record (for IPv4 and IPv6 respectively) to your DNS records."}),"\n",(0,i.jsxs)(n.p,{children:["Log in to your Cloudflare account ",(0,i.jsx)(n.a,{href:"https://dash.cloudflare.com/login",children:"here"})," and select the desired domain."]}),"\n",(0,i.jsxs)(n.p,{children:["On the left side of the page, click on ",(0,i.jsx)(n.code,{children:"DNS"})," and then click on ",(0,i.jsx)(n.code,{children:"Records"}),". Click on ",(0,i.jsx)(n.code,{children:"Create record"}),".",(0,i.jsx)(n.br,{}),"\n","Set the ",(0,i.jsx)(n.code,{children:"Type"})," to ",(0,i.jsx)(n.code,{children:"A"})," and the ",(0,i.jsx)(n.code,{children:"Name"})," to ",(0,i.jsx)(n.code,{children:"@"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["If you want to use subdomains, you should enter the subdomain name (e.g. ",(0,i.jsx)(n.code,{children:"panel"}),") in the ",(0,i.jsx)(n.code,{children:"Name"})," field."]})}),"\n",(0,i.jsxs)(n.p,{children:["Enter your server's IP address in the ",(0,i.jsx)(n.code,{children:"IPv4 address"})," field. and click on ",(0,i.jsx)(n.code,{children:"Save"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Now you need to wait a while for the DNS records to be updated."}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.p,{children:"There is a big difference between yellow cloud (domain is proxied by Cloudflare) and grey cloud (domain is not proxied by Cloudflare) in the Cloudflare control panel."}),(0,i.jsx)(n.p,{children:"If Cloudflare works fine in your region, it is better to proxy the domain through Cloudflare. (Yellow cloud)"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"static",src:r(7789).A+"",width:"1246",height:"529"})}),"\n",(0,i.jsx)(n.p,{children:"Some DNS providers have a different interface, but the overall process is the same."})]})}function a(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},7789:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/cloudflare-dns-bd3780300a96c4c5995bc0a9c86d21d9.webp"},5144:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/issue-cert-f1d2ed47beb605d584203005ca5ea187.webp"},3935:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/login-page-6236b327e75fd1535d4c5f275eabbd20.webp"},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>a});var i=r(6540);const s={},o=i.createContext(s);function t(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);